import{j as o,B as re}from"./index.DEudtTsA.js";import{d as A}from"./createUser.c9022db6.BzOaghnN.js";import{r as x}from"./index.DhYZZe0J.js";import{A as se}from"./athlete.35R8VjyD.js";import"./firstEvent.6da11d29.Cvy-jAXS.js";import"./validateAuth.CUuyyvYq.js";const S="data-astro-transition-persist";function ie(e){for(const t of document.scripts)for(const n of e.scripts)if(!n.hasAttribute("data-astro-rerun")&&(!t.src&&t.textContent===n.textContent||t.src&&t.type===n.type&&t.src===n.src)){n.dataset.astroExec="";break}}function ae(e){const t=document.documentElement,n=[...t.attributes].filter(({name:r})=>(t.removeAttribute(r),r.startsWith("data-astro-")));[...e.documentElement.attributes,...n].forEach(({name:r,value:s})=>t.setAttribute(r,s))}function ce(e){for(const t of Array.from(document.head.children)){const n=ue(t,e);n?n.remove():t.remove()}document.head.append(...e.head.children)}function le(e,t){t.replaceWith(e);for(const n of t.querySelectorAll(`[${S}]`)){const r=n.getAttribute(S),s=e.querySelector(`[${S}="${r}"]`);s&&(s.replaceWith(n),s.localName==="astro-island"&&me(n)&&(n.setAttribute("ssr",""),n.setAttribute("props",s.getAttribute("props"))))}}const de=()=>{const e=document.activeElement;if(e?.closest(`[${S}]`)){if(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement){const t=e.selectionStart,n=e.selectionEnd;return()=>F({activeElement:e,start:t,end:n})}return()=>F({activeElement:e})}else return()=>F({activeElement:null})},F=({activeElement:e,start:t,end:n})=>{e&&(e.focus(),(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)&&(typeof t=="number"&&(e.selectionStart=t),typeof n=="number"&&(e.selectionEnd=n)))},ue=(e,t)=>{const n=e.getAttribute(S),r=n&&t.head.querySelector(`[${S}="${n}"]`);if(r)return r;if(e.matches("link[rel=stylesheet]")){const s=e.getAttribute("href");return t.head.querySelector(`link[rel=stylesheet][href="${s}"]`)}return null},me=e=>{const t=e.dataset.astroTransitionPersistProps;return t==null||t==="false"},fe=e=>{ie(e),ae(e),ce(e);const t=de();le(e.body,document.body),t()},he="astro:before-preparation",pe="astro:after-preparation",be="astro:before-swap",ye="astro:after-swap",ve=e=>document.dispatchEvent(new Event(e));class G extends Event{from;to;direction;navigationType;sourceElement;info;newDocument;signal;constructor(t,n,r,s,a,u,c,d,m,l){super(t,n),this.from=r,this.to=s,this.direction=a,this.navigationType=u,this.sourceElement=c,this.info=d,this.newDocument=m,this.signal=l,Object.defineProperties(this,{from:{enumerable:!0},to:{enumerable:!0,writable:!0},direction:{enumerable:!0,writable:!0},navigationType:{enumerable:!0},sourceElement:{enumerable:!0},info:{enumerable:!0},newDocument:{enumerable:!0,writable:!0},signal:{enumerable:!0}})}}class we extends G{formData;loader;constructor(t,n,r,s,a,u,c,d,m,l){super(he,{cancelable:!0},t,n,r,s,a,u,c,d),this.formData=m,this.loader=l.bind(this,this),Object.defineProperties(this,{formData:{enumerable:!0},loader:{enumerable:!0,writable:!0}})}}class xe extends G{direction;viewTransition;swap;constructor(t,n){super(be,void 0,t.from,t.to,t.direction,t.navigationType,t.sourceElement,t.info,t.newDocument,t.signal),this.direction=t.direction,this.viewTransition=n,this.swap=()=>fe(this.newDocument),Object.defineProperties(this,{direction:{enumerable:!0},viewTransition:{enumerable:!0},swap:{enumerable:!0,writable:!0}})}}async function ge(e,t,n,r,s,a,u,c,d){const m=new we(e,t,n,r,s,a,window.document,u,c,d);return document.dispatchEvent(m)&&(await m.loader(),m.defaultPrevented||(ve(pe),m.navigationType!=="traverse"&&L({scrollX,scrollY}))),m}function Te(e,t){const n=new xe(e,t);return document.dispatchEvent(n),n.swap(),n}const Ee=history.pushState.bind(history),P=history.replaceState.bind(history),L=e=>{history.state&&(history.scrollRestoration="manual",P({...history.state,...e},""))},V=!!document.startViewTransition,q=()=>!!document.querySelector('[name="astro-view-transitions-enabled"]'),K=(e,t)=>e.pathname===t.pathname&&e.search===t.search;let p,T,I;const J=e=>document.dispatchEvent(new Event(e)),Q=()=>J("astro:page-load"),Ae=()=>{let e=document.createElement("div");e.setAttribute("aria-live","assertive"),e.setAttribute("aria-atomic","true"),e.className="astro-route-announcer",document.body.append(e),setTimeout(()=>{let t=document.title||document.querySelector("h1")?.textContent||location.pathname;e.textContent=t},60)},_="data-astro-transition-persist",$="data-astro-transition",C="data-astro-transition-fallback";let W,N=0;history.state?(N=history.state.index,scrollTo({left:history.state.scrollX,top:history.state.scrollY})):q()&&(P({index:N,scrollX,scrollY},""),history.scrollRestoration="manual");async function Se(e,t){try{const n=await fetch(e,t),s=(n.headers.get("content-type")??"").split(";",1)[0].trim();return s!=="text/html"&&s!=="application/xhtml+xml"?null:{html:await n.text(),redirected:n.redirected?n.url:void 0,mediaType:s}}catch{return null}}function Z(){const e=document.querySelector('[name="astro-view-transitions-fallback"]');return e?e.getAttribute("content"):"animate"}function je(){let e=Promise.resolve();for(const t of Array.from(document.scripts)){if(t.dataset.astroExec==="")continue;const n=t.getAttribute("type");if(n&&n!=="module"&&n!=="text/javascript")continue;const r=document.createElement("script");r.innerHTML=t.innerHTML;for(const s of t.attributes){if(s.name==="src"){const a=new Promise(u=>{r.onload=r.onerror=u});e=e.then(()=>a)}r.setAttribute(s.name,s.value)}r.dataset.astroExec="",t.replaceWith(r)}return e}const ee=(e,t,n,r,s)=>{const a=K(t,e),u=document.title;document.title=r;let c=!1;if(e.href!==location.href&&!s)if(n.history==="replace"){const d=history.state;P({...n.state,index:d.index,scrollX:d.scrollX,scrollY:d.scrollY},"",e.href)}else Ee({...n.state,index:++N,scrollX:0,scrollY:0},"",e.href);if(document.title=u,I=e,a||(scrollTo({left:0,top:0,behavior:"instant"}),c=!0),s)scrollTo(s.scrollX,s.scrollY);else{if(e.hash){history.scrollRestoration="auto";const d=history.state;location.href=e.href,history.state||(P(d,""),a&&window.dispatchEvent(new PopStateEvent("popstate")))}else c||scrollTo({left:0,top:0,behavior:"instant"});history.scrollRestoration="manual"}};function Ne(e){const t=[];for(const n of e.querySelectorAll("head link[rel=stylesheet]"))if(!document.querySelector(`[${_}="${n.getAttribute(_)}"], link[rel=stylesheet][href="${n.getAttribute("href")}"]`)){const r=document.createElement("link");r.setAttribute("rel","preload"),r.setAttribute("as","style"),r.setAttribute("href",n.getAttribute("href")),t.push(new Promise(s=>{["load","error"].forEach(a=>r.addEventListener(a,s)),document.head.append(r)}))}return t}async function U(e,t,n,r,s){async function a(d){function m(f){const h=f.effect;return!h||!(h instanceof KeyframeEffect)||!h.target?!1:window.getComputedStyle(h.target,h.pseudoElement).animationIterationCount==="infinite"}const l=document.getAnimations();document.documentElement.setAttribute(C,d);const b=document.getAnimations().filter(f=>!l.includes(f)&&!m(f));return Promise.allSettled(b.map(f=>f.finished))}if(s==="animate"&&!n.transitionSkipped&&!e.signal.aborted)try{await a("old")}catch{}const u=document.title,c=Te(e,n.viewTransition);ee(c.to,c.from,t,u,r),J(ye),s==="animate"&&(!n.transitionSkipped&&!c.signal.aborted?a("new").finally(()=>n.viewTransitionFinished()):n.viewTransitionFinished())}function Pe(){return p?.controller.abort(),p={controller:new AbortController}}async function te(e,t,n,r,s){const a=Pe();if(!q()||location.origin!==n.origin){a===p&&(p=void 0),location.href=n.href;return}const u=s?"traverse":r.history==="replace"?"replace":"push";if(u!=="traverse"&&L({scrollX,scrollY}),K(t,n)&&(e!=="back"&&n.hash||e==="back"&&t.hash)){ee(n,t,r,document.title,s),a===p&&(p=void 0);return}const c=await ge(t,n,e,u,r.sourceElement,r.info,a.controller.signal,r.formData,d);if(c.defaultPrevented||c.signal.aborted){a===p&&(p=void 0),c.signal.aborted||(location.href=n.href);return}async function d(i){const b=i.to.href,f={signal:i.signal};if(i.formData){f.method="POST";const v=i.sourceElement instanceof HTMLFormElement?i.sourceElement:i.sourceElement instanceof HTMLElement&&"form"in i.sourceElement?i.sourceElement.form:i.sourceElement?.closest("form");f.body=v?.attributes.getNamedItem("enctype")?.value==="application/x-www-form-urlencoded"?new URLSearchParams(i.formData):i.formData}const h=await Se(b,f);if(h===null){i.preventDefault();return}if(h.redirected){const v=new URL(h.redirected);if(v.origin!==i.to.origin){i.preventDefault();return}i.to=v}if(W??=new DOMParser,i.newDocument=W.parseFromString(h.html,h.mediaType),i.newDocument.querySelectorAll("noscript").forEach(v=>v.remove()),!i.newDocument.querySelector('[name="astro-view-transitions-enabled"]')&&!i.formData){i.preventDefault();return}const j=Ne(i.newDocument);j.length&&!i.signal.aborted&&await Promise.all(j)}async function m(){if(T&&T.viewTransition){try{T.viewTransition.skipTransition()}catch{}try{await T.viewTransition.updateCallbackDone}catch{}}return T={transitionSkipped:!1}}const l=await m();if(c.signal.aborted){a===p&&(p=void 0);return}if(document.documentElement.setAttribute($,c.direction),V)l.viewTransition=document.startViewTransition(async()=>await U(c,r,l,s));else{const i=(async()=>{await Promise.resolve(),await U(c,r,l,s,Z())})();l.viewTransition={updateCallbackDone:i,ready:i,finished:new Promise(b=>l.viewTransitionFinished=b),skipTransition:()=>{l.transitionSkipped=!0,document.documentElement.removeAttribute(C)}}}l.viewTransition.updateCallbackDone.finally(async()=>{await je(),Q(),Ae()}),l.viewTransition.finished.finally(()=>{l.viewTransition=void 0,l===T&&(T=void 0),a===p&&(p=void 0),document.documentElement.removeAttribute($),document.documentElement.removeAttribute(C)});try{await l.viewTransition.updateCallbackDone}catch(i){const b=i;console.log("[astro]",b.name,b.message,b.stack)}}async function Ie(e,t){await te("forward",I,new URL(e,location.href),{})}function De(e){if(!q()&&e.state){location.reload();return}if(e.state===null)return;const t=history.state,n=t.index,r=n>N?"forward":"back";N=n,te(r,I,new URL(location.href),{},t)}const z=()=>{history.state&&(scrollX!==history.state.scrollX||scrollY!==history.state.scrollY)&&L({scrollX,scrollY})};{if(V||Z()!=="none")if(I=new URL(location.href),addEventListener("popstate",De),addEventListener("load",Q),"onscrollend"in window)addEventListener("scrollend",z);else{let e,t,n,r;const s=()=>{if(r!==history.state?.index){clearInterval(e),e=void 0;return}if(t===scrollY&&n===scrollX){clearInterval(e),e=void 0,z();return}else t=scrollY,n=scrollX};addEventListener("scroll",()=>{e===void 0&&(r=history.state.index,t=scrollY,n=scrollX,e=window.setInterval(s,50))},{passive:!0})}for(const e of document.scripts)e.dataset.astroExec=""}const Re=({children:e,handleSubmit:t,className:n})=>{async function r(s){s.preventDefault(),t()}return o.jsx("form",{onSubmit:r,className:n,children:e})},Oe=()=>{const[e,t]=x.useState(!1),[n,r]=x.useState(null),[s,a]=x.useState(!1),[u,c]=x.useState(!1),[d,m]=x.useState(!1),[l,i]=x.useState(!1),[b,f]=x.useState(!1);x.useEffect(()=>{m(!1),c(!1)},[]);const h=()=>{m(!0),c(!1),b&&(f(!1),v())},j=w=>{const E=w.target.value;a(E==="TI"||E==="RC")},v=async w=>{w&&w.preventDefault();const E=document.getElementById("nombre")?.value,B=document.getElementById("documentNumber")?.value,O=document.getElementById("documentType")?.value,M=document.getElementById("birthDate")?.value,Y=document.getElementById("email")?.value,D=document.getElementById("documentFile")?.files?.[0],R=document.getElementById("documentEPS")?.files?.[0],k=document.getElementById("athletePhoto")?.files?.[0],H=s?document.getElementById("guardianName")?.value:"",X=s?document.getElementById("contactNumber")?.value:"";if(!E||!B||!O||!M||!Y||!D||!R||!k||s&&(!H||!X)){r("Por favor complete todos los campos obligatorios.");return}if(!d){c(!0),f(!0);return}if(D.size>1e6||R.size>1e6||k.size>1e6){alert("El tamaño de los archivos no puede ser mayor a 1MB");return}t(!0),r(null);const g={fullName:E,birthDate:M,documentNumber:B,documentType:O,email:Y,guardianName:H,contactNumber:X},y=new FormData;y.append("documentFile",D),y.append("documentEPS",R),y.append("athletePhoto",k),y.append("fullName",g.fullName),y.append("birthDate",g.birthDate),y.append("documentNumber",g.documentNumber),y.append("documentType",g.documentType),y.append("email",g.email),y.append("guardianName",g.guardianName||""),y.append("contactNumber",g.contactNumber||"");try{await ne(y),Ie("/users")}catch(oe){oe.response?.status===409?r("Este deportista ya está creado."):r("Ocurrió un error al registrar el deportista. Intente de nuevo."),setTimeout(()=>r(null),3e3)}finally{t(!1)}},ne=async w=>{await new se().createAthlete(w)};return o.jsxs(o.Fragment,{children:[u&&o.jsx("div",{className:A["data-policy-modal-overlay"],children:o.jsxs("div",{className:A["data-policy-modal-content"],children:[o.jsx("button",{className:A["data-policy-close-btn"],onClick:()=>c(!1),title:"Cerrar",children:"×"}),o.jsx("h2",{children:"Política de Tratamiento de Datos Personales"}),o.jsxs("div",{className:A["data-policy-scroll"],children:[o.jsx("p",{children:"Al registrarse, usted autoriza el tratamiento de los siguientes datos personales: nombre completo, documento de identidad, correo electrónico, número de contacto, fecha de nacimiento, documentos adjuntos, etc."}),o.jsx("p",{children:"Sus datos serán tratados conforme a la Ley 1581 de 2012 y el Decreto 1377 de 2013."}),o.jsxs("p",{children:["Para más información consulte nuestra"," ",o.jsx("a",{href:"/ruta-a-politica-completa.pdf",target:"_blank",rel:"noopener noreferrer",children:"Política completa aquí"}),"."]}),o.jsxs("div",{className:A["data-policy-checkbox-container"],children:[o.jsx("input",{type:"checkbox",id:"policyCheckbox",checked:l,onChange:w=>i(w.target.checked)}),o.jsx("label",{htmlFor:"policyCheckbox",children:"He leído y acepto la Política de Tratamiento de Datos Personales"})]})]}),o.jsx("button",{className:A["data-policy-accept-btn"],onClick:h,disabled:!l,children:"Acepto"})]})}),o.jsxs(Re,{handleSubmit:v,className:"form",children:[o.jsx("h2",{className:"title",id:"title",children:"ALMIGHTY PLANNY"}),o.jsxs("div",{className:"containerInput",children:[o.jsx("label",{htmlFor:"nombre",children:"Nombre completo del deportista:"}),o.jsx("input",{type:"text",id:"nombre",name:"nombre",required:!0})]}),o.jsxs("div",{className:"containerInput",children:[o.jsx("label",{children:"Selecciona tipo de documento:"}),o.jsxs("select",{id:"documentType",required:!0,onChange:j,children:[o.jsx("option",{value:"",disabled:!0,selected:!0,hidden:!0,children:"Seleccione un documento"}),o.jsx("option",{value:"TI",children:"Tarjeta de identidad"}),o.jsx("option",{value:"CC",children:"Cédula de ciudadanía"}),o.jsx("option",{value:"RC",children:"Registro Civil"}),o.jsx("option",{value:"PA",children:"Pasaporte"})]})]}),o.jsxs("div",{className:"containerInput",children:[o.jsx("label",{htmlFor:"documentNumber",children:"Número de documento:"}),o.jsx("input",{type:"text",id:"documentNumber",required:!0})]}),o.jsxs("div",{className:"containerInput",children:[o.jsx("label",{htmlFor:"email",children:"Correo electrónico:"}),o.jsx("input",{type:"email",id:"email",required:!0})]}),o.jsxs("div",{className:"containerInput",children:[o.jsx("label",{htmlFor:"birthDate",children:"Fecha de nacimiento:"}),o.jsx("input",{type:"date",id:"birthDate",min:"1964-01-01",max:"2019-01-01",required:!0})]}),o.jsx("h4",{children:"Cargue sus documentos"}),o.jsxs("div",{className:"containerInput",children:[o.jsx("label",{children:"Documento de identidad"}),o.jsx("input",{type:"file",id:"documentFile",required:!0})]}),o.jsxs("div",{className:"containerInput",children:[o.jsx("label",{children:"Certificado de EPS"}),o.jsx("input",{type:"file",id:"documentEPS",required:!0})]}),o.jsxs("div",{className:"containerInput",children:[o.jsx("label",{children:"Foto del deportista"}),o.jsx("input",{type:"file",id:"athletePhoto",accept:"image/*",required:!0})]}),s&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"containerInput",children:[o.jsx("label",{htmlFor:"guardianName",children:"Nombre completo del acudiente:"}),o.jsx("input",{type:"text",id:"guardianName",required:!0})]}),o.jsxs("div",{className:"containerInput",children:[o.jsx("label",{htmlFor:"contactNumber",children:"Número de contacto del acudiente:"}),o.jsx("input",{type:"text",id:"contactNumber",required:!0})]})]}),o.jsxs("div",{className:"button-container",children:[n&&o.jsx("div",{className:"floating-message",children:n}),o.jsx(re,{isLoading:e,label:"Registrarse",onClick:v})]})]})]})};export{Oe as CreateAthleteForm};
